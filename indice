<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cálculo Índice de Atraso</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* Altura total para footer colar no fim */
    html, body { height: 100%; }
    /* Fundo gradiente suave */
    body { font-family: 'Montserrat', sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #e4e8eb 100%); overflow-x: hidden; }

    /* Container em coluna para empurrar o rodapé */
    .app-container { min-height: 100vh; max-width: 100%; overflow-x: hidden; display: flex; flex-direction: column; }
    main { flex: 1 1 auto; }

    /* Cartões */
    .card {
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      transition: all 0.4s cubic-bezier(0.175,0.885,0.32,1.275);
      border: 1px solid rgba(255, 255, 255, 0.18);
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(10px);
    }
    .card:hover { box-shadow: 0 15px 35px rgba(0,0,0,0.15); transform: translateY(-5px); }

    /* Botões primário/secundário */
    .btn-primary {
      background: linear-gradient(135deg, #00A86B 0%, #008f5b 100%);
      transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,168,107,0.3);
      position: relative; overflow: hidden;
    }
    .btn-primary:hover { background: linear-gradient(135deg,#00bf78 0%,#00A86B 100%); transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,168,107,0.4); }
    .btn-primary:active { transform: translateY(-1px); }
    .btn-primary::after { content:''; position:absolute; top:50%; left:50%; width:5px; height:5px; background:rgba(255,255,255,0.5); opacity:0; border-radius:100%; transform:scale(1,1) translate(-50%); transform-origin:50% 50%; }
    .btn-primary:focus:not(:active)::after{ animation:ripple 1s ease-out; }
    @keyframes ripple { 0%{transform:scale(0,0); opacity:0.5;} 20%{transform:scale(25,25); opacity:0.3;} 100%{opacity:0; transform:scale(40,40);} }

    .btn-secondary { position:relative; overflow:hidden; transition:all 0.3s ease; }
    .btn-secondary:hover { background-color: rgba(0,0,0,0.05); }
    .btn-secondary::after{ content:''; position:absolute; top:50%; left:50%; width:5px; height:5px; background:rgba(0,0,0,0.2); opacity:0; border-radius:100%; transform:scale(1,1) translate(-50%); transform-origin:50% 50%; }
    .btn-secondary:focus:not(:active)::after{ animation:ripple-dark 1s ease-out; }
    @keyframes ripple-dark { 0%{transform:scale(0,0); opacity:0.3;} 20%{transform:scale(25,25); opacity:0.2;} 100%{opacity:0; transform:scale(40,40);} }

    .btn-scale { transition: transform .3s ease; }
    .btn-scale:hover { transform: scale(1.05); }
    .btn-scale:active { transform: scale(0.95); }

    .highlight { background: linear-gradient(135deg, #FFDE59 0%, #FFD32E 100%); box-shadow: 0 4px 15px rgba(255,222,89,0.3); }

    /* Telas e animações */
    .screen { transition: transform .7s cubic-bezier(.68,-.55,.27,1.55), opacity .7s ease-in-out; }
    .hidden-screen { transform: translateX(100%); opacity:0; position:absolute; }
    .visible-screen { transform: translateX(0); opacity:1; position:relative; }
    .fade-in { animation: fadeIn 1.2s ease-in-out; }
    @keyframes fadeIn { from {opacity:0; transform: translateY(20px);} to {opacity:1; transform: translateY(0);} }
    .pulse { animation: pulse 2s infinite; }
    @keyframes pulse { 0%{transform:scale(1);} 50%{transform:scale(1.05);} 100%{transform:scale(1);} }

    /* Inputs */
    .input-field { transition: all 0.3s ease; border: 2px solid #e2e8f0; background-color: rgba(255,255,255,0.8); }
    .input-field:focus { border-color: #00A86B; box-shadow: 0 0 0 3px rgba(0,168,107,0.2); background-color: #fff; }

    /* Padrão de fundo sutil */
    .bg-pattern{
      background-image:url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2300a86b' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    }

    /* Gauge */
    .meter { transform: rotate(-90deg); }
    .meter circle.track { stroke: #e5e7eb; }
    .meter circle.value { transition: stroke-dashoffset .6s ease, stroke .3s ease; }

    /* Badges */
    .badge { border-radius: 9999px; padding: 6px 10px; font-weight: 600; font-size: .875rem; }
    .badge-ok { background: #dcfce7; color: #166534; }   /* Bom */
    .badge-att { background: #fef9c3; color: #854d0e; }  /* Atenção */
    .badge-high { background: #fee2e2; color: #991b1b; } /* Alto */

    /* Rodapé */
    .site-footer{padding:24px 16px; color:#475569; border-top:1px solid rgba(2,6,23,.08); background:transparent}
    .site-footer .inner{max-width:1200px; margin:0 auto; display:flex; justify-content:center; gap:.5rem}
    .site-footer strong{font-weight:700}
  </style>
</head>
<body class="bg-pattern">
  <div class="app-container">
    <main>
      <!-- Welcome -->
      <div id="welcome-screen" class="screen visible-screen min-h-screen flex flex-col items-center justify-center p-6">
        <!-- Botão Voltar para o Painel (também na tela inicial) -->
        <div class="absolute top-6 left-6">
          <a href="index.html" class="btn-secondary btn-scale text-gray-700 font-medium py-2.5 px-4 rounded-lg flex items-center hover:bg-gray-100 transition-colors">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>
            Voltar para o Painel
          </a>
        </div>

        <div class="text-center max-w-md mx-auto fade-in">
          <div class="mb-8">
            <svg class="w-28 h-28 mx-auto" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" aria-label="Logo">
              <circle cx="50" cy="50" r="45" fill="url(#g)"/>
              <path d="M30 50L45 65L70 35" stroke="white" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>
              <defs>
                <linearGradient id="g" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" stop-color="#00A86B"/>
                  <stop offset="100%" stop-color="#008f5b"/>
                </linearGradient>
              </defs>
            </svg>
          </div>
          <h1 class="text-4xl font-bold text-gray-800 mb-3">Calcular Índice de Atraso</h1>
          <p class="text-gray-600 mb-10 text-lg">Veja rapidamente a porcentagem de pedidos atrasados no eDilig.</p>
          <button id="start-btn" class="btn-primary text-white font-semibold py-4 px-10 rounded-xl text-lg shadow-lg flex items-center justify-center mx-auto btn-scale">
            <span>Começar</span>
            <svg class="w-6 h-6 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/></svg>
          </button>
        </div>
      </div>

      <!-- Calc Screen -->
      <div id="calc-screen" class="screen hidden-screen min-h-screen p-6">
        <div class="max-w-3xl mx-auto">
          <!-- Voltar ao Painel -->
          <div class="flex justify-start mb-6">
            <a href="index.html" class="btn-secondary btn-scale text-gray-700 font-medium py-3 px-6 rounded-lg flex items-center hover:bg-gray-100 transition-colors">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>
              Voltar para o Painel
            </a>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Inputs -->
            <div class="card bg-white rounded-xl p-8">
              <div class="flex items-center mb-6">
                <div class="bg-green-600 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold mr-3 shadow-lg">1</div>
                <h2 class="text-2xl font-bold text-gray-800">Entradas</h2>
              </div>

              <div class="space-y-6">
                <div>
                  <label class="block text-gray-700 font-medium mb-2" for="total-orders">
                    Pedidos totais (eDilig)
                  </label>
                  <input id="total-orders" type="number" min="0" step="1" class="input-field w-full px-4 py-3 rounded-lg text-lg" placeholder="Ex.: 120" required>
                </div>

                <div>
                  <label class="block text-gray-700 font-medium mb-2" for="delayed-orders">
                    Pedidos atrasados
                  </label>
                  <input id="delayed-orders" type="number" min="0" step="1" class="input-field w-full px-4 py-3 rounded-lg text-lg" placeholder="Ex.: 18" required>
                  <p id="error-msg" class="mt-2 text-red-600 text-sm hidden">Os atrasados não podem ser maiores que o total.</p>
                </div>

                <div class="flex items-center justify-between">
                  <button id="restart-btn" class="btn-scale bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-lg flex items-center transition-all hover:shadow-md">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
                    Reiniciar
                  </button>

                  <button id="calc-btn" class="btn-primary text-white font-semibold py-3 px-8 rounded-lg flex items-center">
                    Calcular
                    <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/></svg>
                  </button>
                </div>
              </div>
            </div>

            <!-- Resultado -->
            <div class="card bg-white rounded-xl p-8">
              <div class="flex items-center mb-6">
                <div class="bg-yellow-500 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold mr-3 shadow-lg">2</div>
                <h2 class="text-2xl font-bold text-gray-800">Resultado</h2>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
                <!-- Gauge -->
                <div class="flex items-center justify-center">
                  <svg width="180" height="180" viewBox="0 0 120 120" class="meter">
                    <defs>
                      <linearGradient id="gradGauge" x1="0" y1="0" x2="1" y2="1">
                        <stop offset="0%" stop-color="#22c55e"/>
                        <stop offset="50%" stop-color="#f59e0b"/>
                        <stop offset="100%" stop-color="#ef4444"/>
                      </linearGradient>
                    </defs>
                    <circle class="track" cx="60" cy="60" r="50" stroke-width="12" fill="none" />
                    <circle id="gauge" class="value" cx="60" cy="60" r="50" stroke-width="12" fill="none"
                            stroke="url(#gradGauge)" stroke-linecap="round"
                            stroke-dasharray="314.159" stroke-dashoffset="314.159"/>
                  </svg>
                </div>

                <!-- Números -->
                <div>
                  <div class="result-box bg-gray-50 p-5 rounded-lg mb-4">
                    <p class="text-gray-700 font-medium mb-1">Índice de atraso</p>
                    <div class="flex items-end justify-between">
                      <span id="delay-percent" class="text-3xl font-extrabold">—</span>
                      <span id="status-badge" class="badge hidden">—</span>
                    </div>
                  </div>

                  <div class="grid grid-cols-2 gap-3 text-sm">
                    <div class="p-3 rounded-lg bg-white/70 border border-gray-200">
                      <p class="text-gray-500">Totais</p>
                      <p id="totals-out" class="text-gray-800 font-semibold">—</p>
                    </div>
                    <div class="p-3 rounded-lg bg-white/70 border border-gray-200">
                      <p class="text-gray-500">Atrasados</p>
                      <p id="late-out" class="text-gray-800 font-semibold">—</p>
                    </div>
                  </div>

                  <p id="hint" class="mt-4 text-gray-500 text-sm">Dica: mantenha o índice abaixo de <strong>15%</strong> para um status excelente.</p>
                </div>
              </div>
            </div>
          </div> <!-- /Resultado -->
        </div>
      </div>
    </main>

    <!-- Rodapé fixo ao fim -->
    <footer class="site-footer">
      <div class="inner">
        <span>Desenvolvido por</span>
        <strong>DRHB</strong>
      </div>
    </footer>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const welcome = document.getElementById('welcome-screen');
      const calc = document.getElementById('calc-screen');

      const startBtn = document.getElementById('start-btn');
      const calcBtn = document.getElementById('calc-btn');
      const restartBtn = document.getElementById('restart-btn');

      const totalInp = document.getElementById('total-orders');
      const lateInp = document.getElementById('delayed-orders');
      const err = document.getElementById('error-msg');

      const percentOut = document.getElementById('delay-percent');
      const totalsOut = document.getElementById('totals-out');
      const lateOut = document.getElementById('late-out');
      const badge = document.getElementById('status-badge');
      const gauge = document.getElementById('gauge');

      // feedback de clique
      document.querySelectorAll('button').forEach(btn=>{
        btn.addEventListener('mousedown', ()=> btn.style.transform='scale(0.95)');
        btn.addEventListener('mouseup', ()=> btn.style.transform='');
        btn.addEventListener('mouseleave', ()=> btn.style.transform='');
      });

      function showScreen(screenToShow, screenToHide){
        screenToHide.classList.remove('visible-screen');
        screenToHide.classList.add('hidden-screen');
        setTimeout(()=>{
          screenToShow.classList.remove('hidden-screen');
          screenToShow.classList.add('visible-screen');
        }, 300);
      }

      startBtn.addEventListener('click', ()=>{
        showScreen(calc, welcome);
        // exemplos
        totalInp.value = 120;
        lateInp.value  = 18;
        compute();
      });

      restartBtn.addEventListener('click', ()=>{
        totalInp.value = '';
        lateInp.value = '';
        err.classList.add('hidden');
        renderResult(null);
      });

      calcBtn.addEventListener('click', compute);
      totalInp.addEventListener('input', autoCompute);
      lateInp.addEventListener('input', autoCompute);

      function autoCompute(){
        compute(false);
      }

      // Cálculo
      function compute(showError=true){
        const total = parseInt(totalInp.value, 10);
        const late  = parseInt(lateInp.value, 10);

        if(isNaN(total) || total < 0 || isNaN(late) || late < 0){
          if(showError) err.textContent = 'Preencha valores válidos (≥ 0).';
          err.classList.toggle('hidden', !(showError));
          renderResult(null);
          return;
        }
        if(late > total){
          if(showError) err.textContent = 'Os atrasados não podem ser maiores que o total.';
          err.classList.remove('hidden');
          renderResult(null);
          return;
        }
        err.classList.add('hidden');

        let pct = 0;
        if(total === 0){
          pct = 0; // sem base de cálculo — definimos 0% por convenção
          document.getElementById('hint').innerHTML =
            'Não há base de cálculo (total = 0). Considerando índice <strong>0%</strong>.';
        } else {
          pct = (late / total) * 100;
          document.getElementById('hint').innerHTML =
            'Dica: mantenha o índice abaixo de <strong>15%</strong> para um status excelente.';
        }
        renderResult({ total, late, pct });
      }

      function renderResult(data){
        if(!data){
          percentOut.textContent = '—';
          totalsOut.textContent = '—';
          lateOut.textContent = '—';
          badge.className = 'badge hidden';
          setGauge(0);
          return;
        }
        const { total, late, pct } = data;

        // Duas casas decimais
        const pctStr = pct.toFixed(2).replace('.', ',') + '%';
        percentOut.textContent = pctStr;
        totalsOut.textContent = total.toLocaleString('pt-BR');
        lateOut.textContent = late.toLocaleString('pt-BR');

        /* === NOVAS FAIXAS ===
           > 20%    => Alto
           15–20%   => Atenção
           ≤ 15%    => Bom
        */
        let label = 'Bom', cls = 'badge badge-ok';
        if (pct > 20) { label = 'Alto'; cls = 'badge badge-high'; }
        else if (pct > 15) { label = 'Atenção'; cls = 'badge badge-att'; }
        badge.textContent = label;
        badge.className = cls;

        setGauge(pct);
        percentOut.parentElement.parentElement.classList.add('pulse');
        setTimeout(()=> percentOut.parentElement.parentElement.classList.remove('pulse'), 1500);
      }

      // Gauge (cores ajustadas às faixas)
      const CIRC = 2 * Math.PI * 50; // r=50
      function setGauge(pct){
        const clamped = Math.max(0, Math.min(100, pct));
        const offset = CIRC * (1 - clamped/100);
        gauge.style.strokeDasharray = String(CIRC);
        gauge.style.strokeDashoffset = String(offset);

        // >20 vermelho, >15 laranja, senão verde
        if (clamped > 20)      gauge.style.stroke = '#ef4444';
        else if (clamped > 15) gauge.style.stroke = '#f59e0b';
        else                   gauge.style.stroke = '#22c55e';
      }
    });
  </script>
</body>
</html>
